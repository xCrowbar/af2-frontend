{"id":"node_modules/dag-jose/lib/encryption.js","dependencies":[{"name":"/Users/antoniopipitone/Desktop/af2-frontend/node_modules/dag-jose/lib/encryption.js.map","includedInParent":true,"mtime":1647101807267},{"name":"/Users/antoniopipitone/Desktop/af2-frontend/node_modules/dag-jose/src/encryption.ts","includedInParent":true,"mtime":1647101807329},{"name":"/Users/antoniopipitone/Desktop/af2-frontend/package.json","includedInParent":true,"mtime":1647101976147},{"name":"/Users/antoniopipitone/Desktop/af2-frontend/node_modules/dag-jose/package.json","includedInParent":true,"mtime":1647101807245},{"name":"./utils","loc":{"line":3,"column":24},"parent":"/Users/antoniopipitone/Desktop/af2-frontend/node_modules/dag-jose/lib/encryption.js","resolved":"/Users/antoniopipitone/Desktop/af2-frontend/node_modules/dag-jose/lib/utils.js"}],"generated":{"js":"\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst utils_1 = require(\"./utils\");\nfunction fromSplit(split) {\n    const [protectedHeader, encrypted_key, iv, ciphertext, tag] = split;\n    const jwe = {\n        ciphertext,\n        iv,\n        protected: protectedHeader,\n        tag,\n    };\n    if (encrypted_key)\n        jwe.recipients = [{ encrypted_key }];\n    return jwe;\n}\nfunction encodeRecipient(recipient) {\n    const encRec = {};\n    if (recipient.encrypted_key)\n        encRec.encrypted_key = utils_1.fromBase64url(recipient.encrypted_key);\n    if (recipient.header)\n        encRec.header = recipient.header;\n    return encRec;\n}\nfunction encode(jwe) {\n    const encJwe = {\n        ciphertext: utils_1.fromBase64url(jwe.ciphertext),\n        protected: utils_1.fromBase64url(jwe.protected),\n        iv: utils_1.fromBase64url(jwe.iv),\n        tag: utils_1.fromBase64url(jwe.tag),\n    };\n    if (jwe.aad)\n        encJwe.aad = utils_1.fromBase64url(jwe.aad);\n    if (jwe.recipients)\n        encJwe.recipients = jwe.recipients.map(encodeRecipient);\n    if (jwe.unprotected)\n        encJwe.unprotected = jwe.unprotected;\n    return encJwe;\n}\nfunction decodeRecipient(encoded) {\n    const recipient = {};\n    if (encoded.encrypted_key)\n        recipient.encrypted_key = utils_1.toBase64url(encoded.encrypted_key);\n    if (encoded.header)\n        recipient.header = encoded.header;\n    return recipient;\n}\nfunction decode(encoded) {\n    const jwe = {\n        ciphertext: utils_1.toBase64url(encoded.ciphertext),\n        protected: utils_1.toBase64url(encoded.protected),\n        iv: utils_1.toBase64url(encoded.iv),\n        tag: utils_1.toBase64url(encoded.tag),\n    };\n    if (encoded.aad)\n        jwe.aad = utils_1.toBase64url(encoded.aad);\n    if (encoded.recipients)\n        jwe.recipients = encoded.recipients.map(decodeRecipient);\n    if (encoded.unprotected)\n        jwe.unprotected = encoded.unprotected;\n    return jwe;\n}\nexports.default = {\n    fromSplit,\n    decode,\n    encode,\n};\n"},"sourceMaps":{"js":{"version":3,"file":"encryption.js","sourceRoot":"","sources":["../src/encryption.ts"],"names":[],"mappings":";;AAAA,mCAAoD;AAgCpD,SAAS,SAAS,CAAC,KAAoB;IACrC,MAAM,CAAC,eAAe,EAAE,aAAa,EAAE,EAAE,EAAE,UAAU,EAAE,GAAG,CAAC,GAAG,KAAK,CAAA;IACnE,MAAM,GAAG,GAAW;QAClB,UAAU;QACV,EAAE;QACF,SAAS,EAAE,eAAe;QAC1B,GAAG;KACJ,CAAA;IACD,IAAI,aAAa;QAAE,GAAG,CAAC,UAAU,GAAG,CAAC,EAAE,aAAa,EAAE,CAAC,CAAA;IACvD,OAAO,GAAG,CAAA;AACZ,CAAC;AAED,SAAS,eAAe,CAAC,SAAuB;IAC9C,MAAM,MAAM,GAAqB,EAAE,CAAA;IACnC,IAAI,SAAS,CAAC,aAAa;QAAE,MAAM,CAAC,aAAa,GAAG,qBAAa,CAAC,SAAS,CAAC,aAAa,CAAC,CAAA;IAC1F,IAAI,SAAS,CAAC,MAAM;QAAE,MAAM,CAAC,MAAM,GAAG,SAAS,CAAC,MAAM,CAAA;IACtD,OAAO,MAAM,CAAA;AACf,CAAC;AAED,SAAS,MAAM,CAAC,GAAW;IACzB,MAAM,MAAM,GAAe;QACzB,UAAU,EAAE,qBAAa,CAAC,GAAG,CAAC,UAAU,CAAC;QACzC,SAAS,EAAE,qBAAa,CAAC,GAAG,CAAC,SAAS,CAAC;QACvC,EAAE,EAAE,qBAAa,CAAC,GAAG,CAAC,EAAE,CAAC;QACzB,GAAG,EAAE,qBAAa,CAAC,GAAG,CAAC,GAAG,CAAC;KAC5B,CAAA;IACD,IAAI,GAAG,CAAC,GAAG;QAAE,MAAM,CAAC,GAAG,GAAG,qBAAa,CAAC,GAAG,CAAC,GAAG,CAAC,CAAA;IAChD,IAAI,GAAG,CAAC,UAAU;QAAE,MAAM,CAAC,UAAU,GAAG,GAAG,CAAC,UAAU,CAAC,GAAG,CAAC,eAAe,CAAC,CAAA;IAC3E,IAAI,GAAG,CAAC,WAAW;QAAE,MAAM,CAAC,WAAW,GAAG,GAAG,CAAC,WAAW,CAAA;IACzD,OAAO,MAAM,CAAA;AACf,CAAC;AAED,SAAS,eAAe,CAAC,OAAyB;IAChD,MAAM,SAAS,GAAiB,EAAE,CAAA;IAClC,IAAI,OAAO,CAAC,aAAa;QAAE,SAAS,CAAC,aAAa,GAAG,mBAAW,CAAC,OAAO,CAAC,aAAa,CAAC,CAAA;IACvF,IAAI,OAAO,CAAC,MAAM;QAAE,SAAS,CAAC,MAAM,GAAG,OAAO,CAAC,MAAM,CAAA;IACrD,OAAO,SAAS,CAAA;AAClB,CAAC;AAED,SAAS,MAAM,CAAC,OAAmB;IACjC,MAAM,GAAG,GAAW;QAClB,UAAU,EAAE,mBAAW,CAAC,OAAO,CAAC,UAAU,CAAC;QAC3C,SAAS,EAAE,mBAAW,CAAC,OAAO,CAAC,SAAS,CAAC;QACzC,EAAE,EAAE,mBAAW,CAAC,OAAO,CAAC,EAAE,CAAC;QAC3B,GAAG,EAAE,mBAAW,CAAC,OAAO,CAAC,GAAG,CAAC;KAC9B,CAAA;IACD,IAAI,OAAO,CAAC,GAAG;QAAE,GAAG,CAAC,GAAG,GAAG,mBAAW,CAAC,OAAO,CAAC,GAAG,CAAC,CAAA;IACnD,IAAI,OAAO,CAAC,UAAU;QAAE,GAAG,CAAC,UAAU,GAAG,OAAO,CAAC,UAAU,CAAC,GAAG,CAAC,eAAe,CAAC,CAAA;IAChF,IAAI,OAAO,CAAC,WAAW;QAAE,GAAG,CAAC,WAAW,GAAG,OAAO,CAAC,WAAW,CAAA;IAC9D,OAAO,GAAG,CAAA;AACZ,CAAC;AAED,kBAAe;IACb,SAAS;IACT,MAAM;IACN,MAAM;CACP,CAAA","sourcesContent":["import { fromBase64url, toBase64url } from './utils'\n\ninterface JWERecipient {\n  encrypted_key?: string\n  header?: Record<string, any>\n}\n\nexport interface DagJWE {\n  aad?: string\n  ciphertext: string\n  iv: string\n  protected: string\n  recipients?: Array<JWERecipient>\n  tag: string\n  unprotected?: Record<string, any>\n}\n\ninterface EncodedRecipient {\n  encrypted_key?: Uint8Array\n  header?: Record<string, any>\n}\n\nexport interface EncodedJWE {\n  aad?: Uint8Array\n  ciphertext: Uint8Array\n  iv: Uint8Array\n  protected: Uint8Array\n  recipients?: Array<EncodedRecipient>\n  tag: Uint8Array\n  unprotected?: Record<string, any>\n}\n\nfunction fromSplit(split: Array<string>): DagJWE {\n  const [protectedHeader, encrypted_key, iv, ciphertext, tag] = split\n  const jwe: DagJWE = {\n    ciphertext,\n    iv,\n    protected: protectedHeader,\n    tag,\n  }\n  if (encrypted_key) jwe.recipients = [{ encrypted_key }]\n  return jwe\n}\n\nfunction encodeRecipient(recipient: JWERecipient): EncodedRecipient {\n  const encRec: EncodedRecipient = {}\n  if (recipient.encrypted_key) encRec.encrypted_key = fromBase64url(recipient.encrypted_key)\n  if (recipient.header) encRec.header = recipient.header\n  return encRec\n}\n\nfunction encode(jwe: DagJWE): EncodedJWE {\n  const encJwe: EncodedJWE = {\n    ciphertext: fromBase64url(jwe.ciphertext),\n    protected: fromBase64url(jwe.protected),\n    iv: fromBase64url(jwe.iv),\n    tag: fromBase64url(jwe.tag),\n  }\n  if (jwe.aad) encJwe.aad = fromBase64url(jwe.aad)\n  if (jwe.recipients) encJwe.recipients = jwe.recipients.map(encodeRecipient)\n  if (jwe.unprotected) encJwe.unprotected = jwe.unprotected\n  return encJwe\n}\n\nfunction decodeRecipient(encoded: EncodedRecipient): JWERecipient {\n  const recipient: JWERecipient = {}\n  if (encoded.encrypted_key) recipient.encrypted_key = toBase64url(encoded.encrypted_key)\n  if (encoded.header) recipient.header = encoded.header\n  return recipient\n}\n\nfunction decode(encoded: EncodedJWE): DagJWE {\n  const jwe: DagJWE = {\n    ciphertext: toBase64url(encoded.ciphertext),\n    protected: toBase64url(encoded.protected),\n    iv: toBase64url(encoded.iv),\n    tag: toBase64url(encoded.tag),\n  }\n  if (encoded.aad) jwe.aad = toBase64url(encoded.aad)\n  if (encoded.recipients) jwe.recipients = encoded.recipients.map(decodeRecipient)\n  if (encoded.unprotected) jwe.unprotected = encoded.unprotected\n  return jwe\n}\n\nexport default {\n  fromSplit,\n  decode,\n  encode,\n}\n"]}},"error":null,"hash":"365adb36d98d78a3aaeeb57cc560acdb","cacheData":{"env":{}}}